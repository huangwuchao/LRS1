<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>layout 后台大布局 - Layui</title>

  <link rel="stylesheet" href="../assets/layui-v2.4.5/layui/css/layui.css">
  <script type="text/javascript" src="../assets/layui-v2.4.5/layui/layui.js" charset="utf-8"></script>
  <script type="text/javascript" src="../assets/jquery-3.2.1.js"></script>
  <style type="text/css">
    .layui-nav-item>.frist_accordion{
        font-size: 16px;
    }
    .layui-header>.head_show{
        line-height: 60px;
        font-size: 12px;
        position: absolute;
        left: 220px;
        top: 0;
    }
    .layui-header>.head_show>a{
        padding: 0 4px;
        color: #fff;
    }
    .layui-header .head_show .dark{
        color: #888;
    }
    .layui-header>.head_show>span{
        color: #fff;
    }
    .layui-header>.head_show>a:hover{
        color: rgb(0, 150, 136);
    }
</style>
</head>

<body class="layui-layout-body">
  <div class="layui-layout layui-layout-admin">
    <div class="layui-header">
      <div class="layui-logo">试水后台管理</div>
      <!-- 头部区域（可配合layui已有的水平导航） -->
      <ul class="layui-nav layui-layout-left" style="margin-top:19px;">
        <span class="layui-breadcrumb">
          <a href="javascript:;">首页</a>
          <a href="javascript:;">商品管理</a>
          <a><cite>商品添加</cite></a>
        </span>
      </ul>
      <ul class="layui-nav layui-layout-right">
        <li class="layui-nav-item">
          <a href="javascript:;">
            <img src="http://t.cn/RCzsdCq" class="layui-nav-img">
            贤心
          </a>
          <dl class="layui-nav-child">
            <dd><a href="">没有功能</a></dd>
            <dd><a href="">没有功能</a></dd>
          </dl>
        </li>
        <li class="layui-nav-item"><a href="">退了</a></li>
      </ul>
    </div>

    <div class="layui-side layui-bg-black">
      <div class="layui-side-scroll">
        <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
        <ul class="layui-nav layui-nav-tree" lay-filter="test">
          <li class="layui-nav-item layui-nav-itemed">
            <a class="" href="javascript:;">商品管理</a>
            <dl class="layui-nav-child">
              <dd><a href="shangpin.html">商品列表</a></dd>
              <dd><a href="fenlei.html">商品分类</a></dd>
              <dd><a href="addGood.html">添加商品</a></dd>

            </dl>
          </li>
          <li class="layui-nav-item ">
            <a href="javascript:;">用户管理</a>
            <dl class="layui-nav-child">
              <dd><a href="yonhu.html">用户列表</a></dd>
              <dd><a href="addUser.html">添加用户</a></dd>
            </dl>
          </li>
          <li class="layui-nav-item">
            <a href="javascript:;">订单管理</a>
            <dl class="layui-nav-child">
              <dd><a href="dindan.html">订单列表</a></dd>
            </dl>
          </li>
        </ul>
      </div>
    </div>

    <div class="layui-body">
        <div style="padding: 20px;">
            <!-- 内容主体区域 -->
                
                <!-- 商品名称 -->
                <div class="layui-form-item">
                    <label class="layui-form-label">商品名称：</label>
                    <div class="layui-input-block">
                        <input type="text" name="title" lay-verify="title" autocomplete="off" placeholder="请输入商品名称" class="layui-input add_name">
                    </div>
                </div>
                
                <!-- 分类 -->
                <div class="layui-form-item">
                    <label class="layui-form-label">商品分类：</label>
                    <div class="layui-input-inline">
                        <select name="modules" lay-verify="required" lay-search="" style="height:36px;width:300px;padding-left:10px;border-radius:2px;border-color:#e6e6e6" class="add_categroy">
                           
                        </select>
                    </div>
                </div>
                
                <!-- 原价和现价 -->
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label">原价：</label>
                        <div class="layui-input-inline" style="width: 100px;">
                            <input type="text" name="price_min" placeholder="￥" autocomplete="off" class="layui-input add_oldprice">
                        </div>
                        <div class="layui-form-mid">现价：</div>
                        <div class="layui-input-inline" style="width: 100px;">
                            <input type="text" name="price_max" placeholder="￥" autocomplete="off" class="layui-input add_newprice">
                        </div>
                    </div>
                </div>
                
                <!-- 库存 -->
                <div class="layui-form-item">
                    <label class="layui-form-label">库存：</label>
                    <div class="layui-input-inline">
                        <input type="text" name="username" lay-verify="required" placeholder="请输入库存数量" autocomplete="off" class="layui-input add_number">
                    </div>
                </div>
                
                <!-- 状态 -->
                <div class="layui-form-item" pane="">
                    <label class="layui-form-label">状态：</label>
                    <div class="layui-unselect layui-form-switch layui-form-onswitch btn1" lay-skin="_switch">
                        <em>上架</em>
                        <i></i>
                    </div>
                </div>
                
                <!-- 图片上传 -->
                <div class="layui-upload">
                    <button type="button" class="layui-btn layui-btn-warm" id="test2">多图片上传</button> 
                    <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
                    预览图：（注：第一张为封面）
                        <div class="layui-upload-list" id="demo2">
                        </div>
                    </blockquote>
                </div>
                
                <!-- 说明 -->
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">商品说明：</label>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入内容" class="layui-textarea add_explain"></textarea>
                    </div>
                </div>

                <!-- 提交 -->
                <div style="width: 216px; margin: 0 auto;">
                <!-- layui 2.2.5 新增 -->
                    <button class="layui-btn layui-btn-fluid add_btn">添加</button>
                </div>

            </div>
      <!-- 内容主体区域 -->
      <!-- <div style="padding: 15px;">
        <table class="layui-hide" id="test"></table>
        <form class="layui-form" action="">
          <div class="layui-form-item one">
            <label class="layui-form-label">商品名 </label>
            <div class="layui-input-block" id="two">
              <input type="text" name="username" lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input"
                id="name">
            </div>
            <div class="layui-form-mid layui-word-aux" id="three">50字以内</div>
          </div>

          <div class="layui-form-item one">
            <label class="layui-form-label">商品序号</label>
            <div class="layui-input-block" id="two">
              <input type="text" name="username" id="idxidx" lay-verify="required" placeholder="请输入" autocomplete="off"
                class="layui-input">
            </div>
            <div class="layui-form-mid layui-word-aux" id="three">阿拉伯数字</div>
          </div>

          <div class="layui-form-item">
            <div class="layui-inline">
              <label class="layui-form-label">商品价格</label>
              <div class="layui-input-inline">
                <input type="text" name="number" lay-verify="required|number" autocomplete="off" class="layui-input">
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">销售价格</label>
              <div class="layui-input-inline">
                <input type="text" name="number" id="jiage" lay-verify="required|number" autocomplete="off" class="layui-input">
              </div>
            </div>
          </div>

          <div class="layui-form-item">
            <label class="layui-form-label">商品分类</label>
            <div class="layui-input-block" id="four">
              <select name="interest" lay-filter="aihao" id="fenlei">

                <option value="隐形眼镜">隐形眼镜</option>
                <option value="近视眼镜">近视眼镜</option>
                <option value="功能眼镜">功能眼镜</option>
                <option value="太阳眼镜">太阳眼镜</option>
                <option value="护理用品">护理用品</option>
                <option value="美妆个护">美妆个护</option>
              </select>
            </div>
          </div>

          <div class="layui-upload" id="five">
            <button type="button" class="layui-btn" id="test1">上传图片</button>
            <div class="layui-upload-list">
              <img class="layui-upload-img" id="demo1">
              <p id="demoText"></p>
            </div>
          </div>

          <div class="layui-form-item">
            <div class="layui-inline">
              <label class="layui-form-label">人气</label>
              <div class="layui-input-inline">
                <input type="text" id="renqi" name="number" lay-verify="required|number" autocomplete="off" class="layui-input">
              </div>
            </div>
          </div>

          <div class="layui-form-item">
            <label class="layui-form-label">商品属性</label>
            <div class="layui-input-block">
              <input type="checkbox" name="like[write]" title="热卖">
              <input type="checkbox" name="like[read]" title="推荐" checked="">
              <input type="checkbox" name="like[game]" title="促销">
            </div>
          </div>

          <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">文本域</label>
            <div class="layui-input-block">
              <textarea placeholder="请输入内容" class="layui-textarea" id="jieshao" name="desc"></textarea>
            </div>
          </div>

          <div class="layui-form-item">
            <div class="layui-input-block">
              <button class="layui-btn" lay-submit="" lay-filter="demo1" id="but">立即提交</button>
            </div>
          </div>
        </form>
        <script>
          let _name = $('#anme').val();
          let _idx = $('#idx').val();
          let _jieshao = $('#jieshao').val();
          let _jiage = $('#jiage').val();
          let _renqi = $('#renqi').val();
          let _fenlei = $('#fenlei').val();
          //console.log(_fenlei);
          console.log(_name,_idx,_jieshao,_jiage,_renqi,_fenlei)
          let edit_time = new Date().toLocaleDateString();
         $('#but').on('click',function(){
           
           if(_name && _idx && _jieshao && _jiage && _renqi ){
            console.log(123)
            $.ajax({
                        type:"get",
                        url:"http://localhost:3108/spTianjia",
                        data:{
                            'name':_name,
                            'id':_idx,
                            'jieshao':_jieshao,
                            'prile':_jiage,
                            'renqi':_renqi,
                            'joinTime':edit_time
                        },
                        async:true,
                        success:function(str){
                    
                        }
                    });
                    
           }
         })
          layui.use(['form', 'layedit', 'laydate'], function () {
            var form = layui.form,
              layer = layui.layer,
              layedit = layui.layedit,
              laydate = layui.laydate;

            //创建一个编辑器
            var editIndex = layedit.build('LAY_demo_editor');

            //自定义验证规则
            form.verify({
              title: function (value) {
                if (value.length < 5) {
                  return '标题至少得5个字符啊';
                }
              },
              pass: [
                /^[\S]{6,12}$/, '密码必须6到12位，且不能出现空格'
              ],
              content: function (value) {
                layedit.sync(editIndex);
              }
            });

            //监听指定开关
            form.on('switch(switchTest)', function (data) {
              layer.msg('开关checked：' + (this.checked ? 'true' : 'false'), {
                offset: '6px'
              });
              layer.tips('温馨提示：请注意开关状态的文字可以随意定义，而不仅仅是ON|OFF', data.othis)
            });

            //监听提交
            form.on('submit(demo1)', function (data) {
              layer.alert(JSON.stringify(data.field), {
                title: '最终的提交信息'
              })
              return false;
            });

            //表单初始赋值
            form.val('example', {
              "username": "贤心" // "name": "value"
                ,
              "password": "123456",
              "interest": 1,
              "like[write]": true //复选框选中状态
                ,
              "close": true //开关状态
                ,
              "sex": "女",
              "desc": "我爱 layui"
            })



          });

          layui.use('upload', function () {
            var $ = layui.jquery,
              upload = layui.upload;

            //普通图片上传
            var uploadInst = upload.render({
              elem: '#test1',
              url: '/upload/',
              before: function (obj) {
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                  $('#demo1').attr('src', result); //图片链接（base64）
                });
              },
              done: function (res) {
                //如果上传失败
                if (res.code > 0) {
                  return layer.msg('上传失败');
                }
                //上传成功
              },
              error: function () {
                //演示失败状态，并实现重传
                var demoText = $('#demoText');
                demoText.html(
                  '<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>'
                );
                demoText.find('.demo-reload').on('click', function () {
                  uploadInst.upload();
                });
              }
            });

            //多图片上传
            upload.render({
              elem: '#test2',
              url: '/upload/',
              multiple: true,
              before: function (obj) {
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                  $('#demo2').append('<img src="' + result + '" alt="' + file.name +
                    '" class="layui-upload-img">')
                });
              },
              done: function (res) {
                //上传完毕
              }
            });

            //指定允许上传的文件类型
            upload.render({
              elem: '#test3',
              url: '/upload/',
              accept: 'file' //普通文件
                ,
              done: function (res) {
                console.log(res)
              }
            });
            upload.render({ //允许上传的文件后缀
              elem: '#test4',
              url: '/upload/',
              accept: 'file' //普通文件
                ,
              exts: 'zip|rar|7z' //只允许上传压缩文件
                ,
              done: function (res) {
                console.log(res)
              }
            });
            upload.render({
              elem: '#test5',
              url: '/upload/',
              accept: 'video' //视频
                ,
              done: function (res) {
                console.log(res)
              }
            });
            upload.render({
              elem: '#test6',
              url: '/upload/',
              accept: 'audio' //音频
                ,
              done: function (res) {
                console.log(res)
              }
            });

            //设定文件大小限制
            upload.render({
              elem: '#test7',
              url: '/upload/',
              size: 60 //限制文件大小，单位 KB
                ,
              done: function (res) {
                console.log(res)
              }
            });

            //同时绑定多个元素，并将属性设定在元素上
            upload.render({
              elem: '.demoMore',
              before: function () {
                layer.tips('接口地址：' + this.url, this.item, {
                  tips: 1
                });
              },
              done: function (res, index, upload) {
                var item = this.item;
                console.log(item); //获取当前触发上传的元素，layui 2.1.0 新增
              }
            })

            //选完文件后不自动上传
            upload.render({
              elem: '#test8',
              url: '/upload/',
              auto: false
                //,multiple: true
                ,
              bindAction: '#test9',
              done: function (res) {
                console.log(res)
              }
            });

            //拖拽上传
            upload.render({
              elem: '#test10',
              url: '/upload/',
              done: function (res) {
                console.log(res)
              }
            });

            //多文件列表示例
            var demoListView = $('#demoList'),
              uploadListIns = upload.render({
                elem: '#testList',
                url: '/upload/',
                accept: 'file',
                multiple: true,
                auto: false,
                bindAction: '#testListAction',
                choose: function (obj) {
                  var files = this.files = obj.pushFile(); //将每次选择的文件追加到文件队列
                  //读取本地文件
                  obj.preview(function (index, file, result) {
                    var tr = $(['<tr id="upload-' + index + '">', '<td>' + file.name + '</td>', '<td>' + (
                        file.size / 1014).toFixed(1) + 'kb</td>', '<td>等待上传</td>', '<td>',
                      '<button class="layui-btn layui-btn-xs demo-reload layui-hide">重传</button>',
                      '<button class="layui-btn layui-btn-xs layui-btn-danger demo-delete">删除</button>',
                      '</td>', '</tr>'
                    ].join(''));

                    //单个重传
                    tr.find('.demo-reload').on('click', function () {
                      obj.upload(index, file);
                    });

                    //删除
                    tr.find('.demo-delete').on('click', function () {
                      delete files[index]; //删除对应的文件
                      tr.remove();
                      uploadListIns.config.elem.next()[0].value = ''; //清空 input file 值，以免删除后出现同名文件不可选
                    });

                    demoListView.append(tr);
                  });
                },
                done: function (res, index, upload) {
                  if (res.code == 0) { //上传成功
                    var tr = demoListView.find('tr#upload-' + index),
                      tds = tr.children();
                    tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
                    tds.eq(3).html(''); //清空操作
                    return delete this.files[index]; //删除文件队列已经上传成功的文件
                  }
                  this.error(index, upload);
                },
                error: function (index, upload) {
                  var tr = demoListView.find('tr#upload-' + index),
                    tds = tr.children();
                  tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
                  tds.eq(3).find('.demo-reload').removeClass('layui-hide'); //显示重传
                }
              });

            //绑定原始文件域
            upload.render({
              elem: '#test20',
              url: '/upload/',
              done: function (res) {
                console.log(res)
              }
            });

          });
        </script>
      </div> -->
    </div>

    <!-- <div class="layui-footer">
    底部固定区域
    © layui.com - 底部固定区域
  </div> -->
  </div>
  
  <script>
      //JavaScript代码区域
      layui.use('element', function(){
          var element = layui.element;

          var foot_time1 =  new Date().toLocaleDateString();//年月日
          var foot_time2 =  new Date().toLocaleTimeString();//时分秒
          $('.foot_time').html('日期：'+foot_time1+'&nbsp&nbsp&nbsp&nbsp'+foot_time2);//显示时间
          clearInterval(timer1);
          var timer1 = setInterval(function(){
              foot_time1 =  new Date().toLocaleDateString();//获取时间
              foot_time2 =  new Date().toLocaleTimeString();//获取时间
              $('.foot_time').html('日期：'+foot_time1+'&nbsp&nbsp&nbsp&nbsp'+foot_time2);//显示时间
          },1000);

          $('.log_out').click(function(){
          //点击退出按钮
          });
      });

      //上/下架按钮
      var btn1_num=0;
      $('.btn1').click(function(){
          btn1_num++;
          if(btn1_num%2 == 0){
              $('.btn1').addClass('layui-form-onswitch');
              $('.btn1').find('em').html('上架');
          }else{
              $('.btn1').removeClass('layui-form-onswitch');
              $('.btn1').find('em').html('已下架');
          }
      })
  </script>

  <script>
      layui.use('upload', function(){
          var $ = layui.jquery
          ,upload = layui.upload;

          //多图片上传
          upload.render({
              elem: '#test2'
              ,url: 'http://localhost:3108/addpic'
              ,multiple: true
              ,before: function(obj){
              //预读本地文件示例，不支持ie8
              obj.preview(function(index, file, result){
                  $('#demo2').append('<img src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img add_img" style="width:92px;height:92px;margin:0 10px 10px 0">')
                  });
              }
              ,done: function(res){
                  
              }
          });
      });
  </script>

  <script type="text/javascript">
      // 渲染分类
      $.ajax({
          type:"get",
          url:"http://localhost:3108/cate",
          async:"true",
          data:{
          },
          success:function(str){
              var res = str.map(function(item){
                  return `<option>${item}</option>`
              }).join('');
              res='<option>选择商品分类</option>'+res;
              $('.add_categroy').html(res);
          }
      });

      //提交
      var addpict=[];
      $('.add_btn').click(function(){
          var add_name = $('.add_name').val();//商品名称
          var add_categroy = $('.add_categroy option:selected').html();//商品分类
          var add_oldprice = $('.add_oldprice').val();//原价
          var add_newprice = $('.add_newprice').val();//现价
          var add_stage = $('.btn1').find('em').html();//状态
          var add_explain = $('.add_explain').val();//商品说明
          var add_time = new Date().toLocaleDateString().split('/');
          var add_time = add_time[0]+'-'+add_time[1]+'-'+add_time[2]//添加时间
          var add_img = $('.add_img');
          for(var j=0;j<add_img.length;j++){
              var Arr=$('#demo2').find('img').eq(j).attr('alt')
              addpict.push(Arr);
          }
          // console.log(addpict);添加图片
          var add_number = $('.add_number').val();//库存

          if(add_name&&add_categroy&&add_oldprice&&add_newprice&&add_number&&add_explain){
              if(add_categroy!='选择商品分类'){
                  $.ajax({
                      type:"post",
                      url:"http://localhost:3108/spTianjia",
                      async:"true",
                      data:{
                          'mane':add_name,
                          // 'categroy':add_categroy,
                          // 'oldprice':add_oldprice,
                          'prile':add_newprice,
                          'renqi':add_number,
                          'zt':add_stage,
                          'url':addpict,
                          'jieshao':add_explain,
                          'joinTime':add_time
                      },
                      success:function(str){
                  
                      }
                  });
              }else{
                  alert('请输入正确的信息');
              }

          }else{
              alert('请将信息补充完整');
          }
          
          console.log(add_name);
          console.log(add_categroy);
          console.log(add_oldprice);
          console.log(add_newprice);
          console.log(add_number);
          console.log(add_stage);
          console.log(addpict);
          console.log(add_explain);
          console.log(add_time);




      })
  </script>
  <script>
    //JavaScript代码区域
    layui.use('element', function () {
      var element = layui.element;

    });
  </script>
</body>

</html>